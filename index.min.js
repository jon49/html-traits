(()=>{var n=new Map;function f(t,e){if(t=t.trim(),t==="")throw new Error("Trait name cannot be empty");if(n.has(t))throw new Error(`Trait "${t}" already defined`);n.set(t,e)}var a=new WeakMap;function i(t){var e=t.getAttribute("traits");if(e){var r=[];for(let o of e.split(/\s+/))if(n.has(o)&&!a.has(t)){var c=new(n.get(o))(t);r.push(c)}r.length&&a.set(t,r)}}function d(t){t.hasAttribute?.("traits")&&s(t);for(let e of t.querySelectorAll?.("[traits]")??[])s(e)}function s(t){var e=a.get(t);for(let r of e??[])typeof r.disconnectedCallback=="function"&&r.disconnectedCallback();a.delete(t)}var l=new MutationObserver(function(t){for(let e of t){for(let r of Array.from(e.addedNodes))r.nodeType===1&&r.hasAttribute?.("traits")&&i(r),r.querySelectorAll?.("[traits]").forEach(i);Array.from(e.removedNodes).forEach(d)}});document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll("[traits]").forEach(i)});l.observe(document,{childList:!0,subtree:!0});window.defineTrait=f;})();
